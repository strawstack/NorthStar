<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>input</title>
  </head>
  <body>
    <a href="javascript: function runWithPeer(userFunction, second, third) {document.querySelectorAll('.northstar').forEach(e => e.remove());const script = document.createElement('script');script.type = 'module';script.className = 'northstar';const importPeer = `import {Peer} from 'https://esm.sh/peerjs@1.5.4?bundle-deps';\n`;let funct = userFunction.toString().replace('SECOND', second).replace('THIRD', third);script.innerHTML = `${importPeer}(${funct})();`;document.body.appendChild(script);} function buildFunctionCall(funct, arg) {arg = (arg) ? arg : '';return `(${funct.toString()})(${arg})`;}function northStar(userFunction, pid) {let Peer = () => {};let SECOND = '';if (pid) {runWithPeer(() => {const peer = new Peer();peer.on('open', _ => {const conn = peer.connect('SECOND');conn.on('data', (data) => {THIRD});});}, pid, buildFunctionCall(userFunction, 'data'));} else {runWithPeer(() => {const peer = new Peer();peer.on('open', (id) => {console.log(id);});peer.on('connection', (conn) => {conn.on('open', () => {conn.send(SECOND);});});}, buildFunctionCall(userFunction));}}">northstar</a>
</body></html>